<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DevServer | Jerry 个人博客</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <script>
      (function() {
        var mta = document.createElement("script");
        mta.src = "//pingjs.qq.com/h5/stats.js?v2.0.4";
        mta.setAttribute("name", "MTAH5");
        mta.setAttribute("sid", "500708667");
        mta.setAttribute("cid", "500708668");
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(mta, s);
      })();
    </script>
    <script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="Jerry's blog">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/assets/css/0.styles.06744937.css" as="style"><link rel="preload" href="/assets/js/app.60e74413.js" as="script"><link rel="preload" href="/assets/js/14.69f023c0.js" as="script"><link rel="preload" href="/assets/js/2.720ba71e.js" as="script"><link rel="preload" href="/assets/js/6.95b28193.js" as="script"><link rel="prefetch" href="/assets/js/10.4356ad27.js"><link rel="prefetch" href="/assets/js/100.c99580b9.js"><link rel="prefetch" href="/assets/js/101.356781a9.js"><link rel="prefetch" href="/assets/js/11.b045add9.js"><link rel="prefetch" href="/assets/js/12.aeedaf60.js"><link rel="prefetch" href="/assets/js/13.fb627b38.js"><link rel="prefetch" href="/assets/js/15.9fedbce0.js"><link rel="prefetch" href="/assets/js/16.1a7de72a.js"><link rel="prefetch" href="/assets/js/17.fa224a6a.js"><link rel="prefetch" href="/assets/js/18.1a72bef8.js"><link rel="prefetch" href="/assets/js/19.e11c0116.js"><link rel="prefetch" href="/assets/js/20.6a6f73dd.js"><link rel="prefetch" href="/assets/js/21.56a777d3.js"><link rel="prefetch" href="/assets/js/22.6773a84c.js"><link rel="prefetch" href="/assets/js/23.136061fb.js"><link rel="prefetch" href="/assets/js/24.7d1837f0.js"><link rel="prefetch" href="/assets/js/25.31ab58df.js"><link rel="prefetch" href="/assets/js/26.a5e7b497.js"><link rel="prefetch" href="/assets/js/27.9609abfa.js"><link rel="prefetch" href="/assets/js/28.bbb9cd06.js"><link rel="prefetch" href="/assets/js/29.8892b17d.js"><link rel="prefetch" href="/assets/js/3.b7eab624.js"><link rel="prefetch" href="/assets/js/30.74b203cc.js"><link rel="prefetch" href="/assets/js/31.f8502b39.js"><link rel="prefetch" href="/assets/js/32.4a6fdb4c.js"><link rel="prefetch" href="/assets/js/33.06378ca2.js"><link rel="prefetch" href="/assets/js/34.0060ef5f.js"><link rel="prefetch" href="/assets/js/35.1635574b.js"><link rel="prefetch" href="/assets/js/36.ba0ea7aa.js"><link rel="prefetch" href="/assets/js/37.1fe72493.js"><link rel="prefetch" href="/assets/js/38.6140df13.js"><link rel="prefetch" href="/assets/js/39.75defbda.js"><link rel="prefetch" href="/assets/js/4.99432b89.js"><link rel="prefetch" href="/assets/js/40.95f6174a.js"><link rel="prefetch" href="/assets/js/41.edc39790.js"><link rel="prefetch" href="/assets/js/42.9dcf7ed0.js"><link rel="prefetch" href="/assets/js/43.027f7ff4.js"><link rel="prefetch" href="/assets/js/44.a7fa2c02.js"><link rel="prefetch" href="/assets/js/45.3bd0a364.js"><link rel="prefetch" href="/assets/js/46.6682a04b.js"><link rel="prefetch" href="/assets/js/47.a61c377c.js"><link rel="prefetch" href="/assets/js/48.1f4bbd9a.js"><link rel="prefetch" href="/assets/js/49.7f23a237.js"><link rel="prefetch" href="/assets/js/5.406f67b1.js"><link rel="prefetch" href="/assets/js/50.2a56a559.js"><link rel="prefetch" href="/assets/js/51.bb97c3da.js"><link rel="prefetch" href="/assets/js/52.446d5740.js"><link rel="prefetch" href="/assets/js/53.e8184b0c.js"><link rel="prefetch" href="/assets/js/54.c9a5e3ed.js"><link rel="prefetch" href="/assets/js/55.97bb4c63.js"><link rel="prefetch" href="/assets/js/56.cb3d973f.js"><link rel="prefetch" href="/assets/js/57.37f3fb00.js"><link rel="prefetch" href="/assets/js/58.0d7c2f4b.js"><link rel="prefetch" href="/assets/js/59.4a2f6def.js"><link rel="prefetch" href="/assets/js/60.b2a604a0.js"><link rel="prefetch" href="/assets/js/61.debbb7b9.js"><link rel="prefetch" href="/assets/js/62.0bd56b0e.js"><link rel="prefetch" href="/assets/js/63.57bf8cbe.js"><link rel="prefetch" href="/assets/js/64.41c1fb35.js"><link rel="prefetch" href="/assets/js/65.f53d1b42.js"><link rel="prefetch" href="/assets/js/66.566689b9.js"><link rel="prefetch" href="/assets/js/67.f5cf077d.js"><link rel="prefetch" href="/assets/js/68.95bc1b6c.js"><link rel="prefetch" href="/assets/js/69.bdc844a1.js"><link rel="prefetch" href="/assets/js/7.6619bfc9.js"><link rel="prefetch" href="/assets/js/70.94a6894a.js"><link rel="prefetch" href="/assets/js/71.4e9ddb06.js"><link rel="prefetch" href="/assets/js/72.2c8413d7.js"><link rel="prefetch" href="/assets/js/73.64fdac61.js"><link rel="prefetch" href="/assets/js/74.a6f66ae3.js"><link rel="prefetch" href="/assets/js/75.9e940b3a.js"><link rel="prefetch" href="/assets/js/76.7e0d8e19.js"><link rel="prefetch" href="/assets/js/77.c67342fb.js"><link rel="prefetch" href="/assets/js/78.a5bd97d1.js"><link rel="prefetch" href="/assets/js/79.3a3e3541.js"><link rel="prefetch" href="/assets/js/8.d0a8a3ed.js"><link rel="prefetch" href="/assets/js/80.97620f66.js"><link rel="prefetch" href="/assets/js/81.0d8341aa.js"><link rel="prefetch" href="/assets/js/82.0d309601.js"><link rel="prefetch" href="/assets/js/83.6123aeae.js"><link rel="prefetch" href="/assets/js/84.00b21399.js"><link rel="prefetch" href="/assets/js/85.d22ae4f9.js"><link rel="prefetch" href="/assets/js/86.a79065fe.js"><link rel="prefetch" href="/assets/js/87.01664722.js"><link rel="prefetch" href="/assets/js/88.1cb8429e.js"><link rel="prefetch" href="/assets/js/89.a36be8c5.js"><link rel="prefetch" href="/assets/js/9.f2277063.js"><link rel="prefetch" href="/assets/js/90.ebfec47e.js"><link rel="prefetch" href="/assets/js/91.47f73c78.js"><link rel="prefetch" href="/assets/js/92.4ae86837.js"><link rel="prefetch" href="/assets/js/93.8bbf0769.js"><link rel="prefetch" href="/assets/js/94.8f1e3309.js"><link rel="prefetch" href="/assets/js/95.ea1c2085.js"><link rel="prefetch" href="/assets/js/96.08475163.js"><link rel="prefetch" href="/assets/js/97.a8c7442e.js"><link rel="prefetch" href="/assets/js/98.9d7ce618.js"><link rel="prefetch" href="/assets/js/99.eb0c7f6a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.06744937.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Jerry 个人博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/js/index.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/basic/css/index.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/basic/html/index.html" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/http/index.html" class="nav-link">
  HTTP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue 系列" class="dropdown-title"><span class="title">Vue 系列</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/vue/vue2/index.html" class="nav-link">
  Vue 2
</a></li><li class="dropdown-item"><!----> <a href="/tools/vue/vue3/index.html" class="nav-link">
  Vue 3
</a></li><li class="dropdown-item"><!----> <a href="/tools/vue/vuex/index.html" class="nav-link">
  Vuex
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="源码精读" class="dropdown-title"><span class="title">源码精读</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/snabbdom/index.html" class="nav-link">
  Snabbdom
</a></li><li class="dropdown-item"><!----> <a href="/tools/axios/index.html" class="nav-link">
  Axios
</a></li></ul></div></div><div class="nav-item"><a href="/backend/" class="nav-link">
  技能拓展
</a></div><div class="nav-item"><a href="/tools/webpack/" class="nav-link router-link-active">
  Webpack
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About Me
</a></div> <a href="https://github.com/JerryYuanJ/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/js/index.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/basic/css/index.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/basic/html/index.html" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/http/index.html" class="nav-link">
  HTTP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue 系列" class="dropdown-title"><span class="title">Vue 系列</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/vue/vue2/index.html" class="nav-link">
  Vue 2
</a></li><li class="dropdown-item"><!----> <a href="/tools/vue/vue3/index.html" class="nav-link">
  Vue 3
</a></li><li class="dropdown-item"><!----> <a href="/tools/vue/vuex/index.html" class="nav-link">
  Vuex
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="源码精读" class="dropdown-title"><span class="title">源码精读</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/snabbdom/index.html" class="nav-link">
  Snabbdom
</a></li><li class="dropdown-item"><!----> <a href="/tools/axios/index.html" class="nav-link">
  Axios
</a></li></ul></div></div><div class="nav-item"><a href="/backend/" class="nav-link">
  技能拓展
</a></div><div class="nav-item"><a href="/tools/webpack/" class="nav-link router-link-active">
  Webpack
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About Me
</a></div> <a href="https://github.com/JerryYuanJ/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>配置大全</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tools/webpack/entry-context.html" class="sidebar-link">entry 和 context</a></li><li><a href="/tools/webpack/output.html" class="sidebar-link">output</a></li><li><a href="/tools/webpack/dev-server.html" aria-current="page" class="active sidebar-link">devServer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#配置" class="sidebar-link">配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#port-🔑" class="sidebar-link">port 🔑</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#open-🔑" class="sidebar-link">open 🔑</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#openpage" class="sidebar-link">openPage</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#compress" class="sidebar-link">compress</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#writetodisk" class="sidebar-link">writeToDisk</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#onlistening" class="sidebar-link">onListening</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#before-🔑" class="sidebar-link">before 🔑</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#after" class="sidebar-link">after</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#clientloglevel" class="sidebar-link">clientLogLevel</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#overlay" class="sidebar-link">overlay</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#quiet" class="sidebar-link">quiet</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#noinfo" class="sidebar-link">noInfo</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#stats" class="sidebar-link">stats</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#inline-🔑" class="sidebar-link">inline 🔑</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#public" class="sidebar-link">public</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#publicpath-🔑" class="sidebar-link">publicPath 🔑</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#https" class="sidebar-link">https</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#http2" class="sidebar-link">http2</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#index" class="sidebar-link">index</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#allowedhosts" class="sidebar-link">allowedHosts</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#disablehostcheck" class="sidebar-link">disableHostCheck</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#host-🔑" class="sidebar-link">host 🔑</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#uselocalip" class="sidebar-link">useLocalIp</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#hot-🔑" class="sidebar-link">hot 🔑</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#hotonly-🔑" class="sidebar-link">hotOnly 🔑</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#contentbase-🔑" class="sidebar-link">contentBase 🔑</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#contentbasepublicpath-🔑" class="sidebar-link">contentBasePublicPath 🔑</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#watchcontentbase" class="sidebar-link">watchContentBase</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#watchoptions" class="sidebar-link">watchOptions</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#headers" class="sidebar-link">headers</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#livereload" class="sidebar-link">liveReload</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#socket-相关" class="sidebar-link">socket 相关</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#historyapifallback-🔑" class="sidebar-link">historyApiFallback 🔑</a></li><li class="sidebar-sub-header"><a href="/tools/webpack/dev-server.html#proxy-🔑" class="sidebar-link">proxy 🔑</a></li></ul></li></ul></li><li><a href="/tools/webpack/performance.html" class="sidebar-link">performance</a></li><li><a href="/tools/webpack/watch.html" class="sidebar-link">watch 和 watchOptions</a></li><li><a href="/tools/webpack/resolve.html" class="sidebar-link">resolve 和 resolveLoader</a></li><li><a href="/tools/webpack/externals.html" class="sidebar-link">externals 和 externalsType</a></li><li><a href="/tools/webpack/module.html" class="sidebar-link">module</a></li><li><a href="/tools/webpack/optimization.html" class="sidebar-link">optimization</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>优化技巧</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tools/webpack/optimize.html" class="sidebar-link">Webpack优化技巧</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>进阶学习</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tools/webpack/tappable.html" class="sidebar-link">事件系统的核心 - Tappable</a></li><li><a href="/tools/webpack/hashes.html" class="sidebar-link">hash, chunkhash 和 contenthash</a></li><li><a href="/tools/webpack/loader.html" class="sidebar-link">Webpack Loader</a></li><li><a href="/tools/webpack/plugin.html" class="sidebar-link">Webpack Plugin</a></li></ul></section></li></ul> <div class="adsense-content" data-v-8d82fd90><div style="padding: 2rem" data-v-8d82fd90></div></div></aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="devserver"><a href="#devserver" class="header-anchor">#</a> DevServer</h1> <p>在开发过程中，利用合理的 <code>devServer</code> 配置，可以有效的提高我们的工作效率。本节我们就来看看如果对 <code>devServer</code> 进行配置。</p> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <p>在介绍具体内容之前，你需要先安装这个包：</p> <div class="language- extra-class"><pre class="language-text"><code>npm install webpack-dev-server
</code></pre></div><p>接着配置一个 npm script 即可：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>最后执行 <code>npm run dev</code>，你的应用就成功的运行在这个开发服务器上了。这时候如果你没有在 webpack 配置文件中配置 devServer 属性的话，会采用它的默认配置，比如默认端口是 8080 等。接下来我们细说它的各项配置。</p> <h2 id="配置"><a href="#配置" class="header-anchor">#</a> 配置</h2> <h3 id="port-🔑"><a href="#port-🔑" class="header-anchor">#</a> port 🔑</h3> <p>服务器运行的端口号，默认 8080。</p> <h3 id="open-🔑"><a href="#open-🔑" class="header-anchor">#</a> open 🔑</h3> <p>是否自动的打开浏览器。设置为 true 的话，会自动的打开你的<strong>默认浏览器</strong>。</p> <p>如果你想打开指定浏览器的话，比如你在 Mac OS 上想默认打开 Firefox，你可以设置：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  open<span class="token operator">:</span> <span class="token string">'Firefox'</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>注意，这里的浏览器名称需要是你本地 app 的名称，比如谷歌浏览器在 Mac 上叫做 Google Chrome，在 Windows 上叫做 chrome。</p></div> <p>在 <strong>webpack V5</strong> 中，你也可以指定 open 属性为一个对象，它的配置和 <a href="https://www.npmjs.com/package/open" target="_blank" rel="noopener noreferrer">open<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 一样，比如我要配置默认打开 Chrome 浏览器，并且开启隐私模式，你可以这么设置：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  open<span class="token operator">:</span> <span class="token punctuation">{</span>
    app<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Google Chrome'</span><span class="token punctuation">,</span> <span class="token string">'--incognito'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="openpage"><a href="#openpage" class="header-anchor">#</a> openPage</h3> <p>当打开浏览器的时候，指定要打开的页面。它可以是字符串类型的，也可以是数组，表示要打开一组页面。</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  openPage<span class="token operator">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
  <span class="token comment">// openPage: ['index.html', 'login.html'],</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="compress"><a href="#compress" class="header-anchor">#</a> compress</h3> <p>启用 gizp 压缩。它是一个布尔值。</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  compress<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当你设置为 true 时，响应头会多出如下字段：</p> <div class="language- extra-class"><pre class="language-text"><code>Content-Encoding: gzip
</code></pre></div><h3 id="writetodisk"><a href="#writetodisk" class="header-anchor">#</a> writeToDisk</h3> <p>是否将打包生成的文件写入到硬盘中。我们知道，开发服务器下的生成文件是在内存中的，如果你想在本地看到开发环境下打包生成的文件是啥样的，可以将它设置为 true。</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  writeToDisk<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>它会将生成的文件放在 output.path 中配置的路径中</strong>。它的值也可以是一个函数，函数接收一个文件路径作为参数，返回一个布尔值来决定这个文件要不要写进硬盘，例如下面的配置，就只将 js 文件写进硬盘中：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">writeToDisk</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">/</span>\<span class="token punctuation">.</span>js$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="onlistening"><a href="#onlistening" class="header-anchor">#</a> onListening</h3> <p>当 webpack-dev-server 开始监听端口上的连接时，要执行的操作。他是一个函数。</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">onListening</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">server</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> port <span class="token operator">=</span> server<span class="token punctuation">.</span>listeningApp<span class="token punctuation">.</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>port<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Listening on port:'</span><span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="before-🔑"><a href="#before-🔑" class="header-anchor">#</a> before 🔑</h3> <p>它是一个函数，在 webpack-dev-server 所有的内置中间件执行前执行。我们可以在函数中做很多有意思的事，比如数据 mock等。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">before</span><span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/user/1'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Jerry'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面的代码，相当于 mock 了一个 <code>/api/user/1</code> 的接口，它返回一个 json 对象。你可以在你的业务代码中调用这个接口，例如通过 axios 请求：</p> <div class="language-js extra-class"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/user/1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// handle res</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="after"><a href="#after" class="header-anchor">#</a> after</h3> <p>它也是一个函数，在 dev-server 内部中间件执行完之后执行。你也可以在这里进行数据 mock，这里就不多解释了。它和 before 相当于两个钩子，一个在 dev-server 所有内置中间件执行前执行，一个在 dev-server 所有内置中间件执行之后执行。</p> <h3 id="clientloglevel"><a href="#clientloglevel" class="header-anchor">#</a> clientLogLevel</h3> <p>设置你 DevTool 上控制台的日志级别。我们在浏览器的控制台上，经常会看到一些日志信息或者一些编译警告或者错误信息，比如：</p> <div class="language- extra-class"><pre class="language-text"><code>[WDS] App updated. Recompiling...
[WDS] App hot update...
[HMR] Checking for updates on the server...
[HMR] Nothing hot updated.
[HMR] App is up to date.
</code></pre></div><p>你可以通过设置不同的级别来限制控制台的输出：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  clientLogLevel<span class="token operator">:</span> <span class="token string">'error'</span> <span class="token comment">// 只显示错误信息</span>
<span class="token punctuation">}</span>
</code></pre></div><p>类似的级别还有 info，debug，warn 等。<strong>如果你嫌日志太多很烦，那么可以设置为 <code>silent</code> 来关掉日志（但是错误信息还是会展示）。</strong></p> <h3 id="overlay"><a href="#overlay" class="header-anchor">#</a> overlay</h3> <p>当 <strong>编译报警告或者出错</strong> 的时候，是否在浏览器上显示一个全屏的遮层来展示这些信息。注意这里显示的编译相关的信息，比如你的代码不符合某个 eslint 标准，或者代码少个括号等会引起编译出错的时候。比如如下代码：</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'hello'</span>
</code></pre></div><p>会报错：</p> <p><img src="/assets/img/compile_error.5c964ed5.png" alt="compile error"></p> <p>当设置为 true 的时候，只会显示错误信息。如果你想显示警告信息和错误信息的话，可以设置成一个对象：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  overlay<span class="token operator">:</span> <span class="token punctuation">{</span>
    warnings<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    errors<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="quiet"><a href="#quiet" class="header-anchor">#</a> quiet</h3> <p>我们知道，当运行 <code>npm run dev</code> 时，命令行会打印出很多日志：</p> <p><img src="/assets/img/console_info.22902bf7.png" alt="console info"></p> <p>你可以通过设置 quiet 为 true 来禁用掉日志。<strong>注意，此时警告和错误信息也不会显示了，所以这个属性还是慎用。</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  quiet<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="/assets/img/console_quiet.6137d58a.png" alt="console quiet"></p> <h3 id="noinfo"><a href="#noinfo" class="header-anchor">#</a> noInfo</h3> <p>它也是一个日志输出的控制。noInfo 的作用是不输出 webpack 的打包信息，但是对于错误和警告还是会输出的。关于它和 quiet 的优先级，读者可以自行尝试一下。</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  noInfo<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="/assets/img/console_noinfo.f9747294.png" alt="console info noinfo"></p> <h3 id="stats"><a href="#stats" class="header-anchor">#</a> stats</h3> <p><strong>这个选项可以让你精确地控制显示什么 bundle 信息，它是用来控制 bundle 信息的显示的。</strong> 如果你不想使用 noInfo 和 quiet 来配置的话，这也是一个不错的选择。你可以参考 <a href="https://webpack.js.org/configuration/stats/" target="_blank" rel="noopener noreferrer">stats<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 配置来更进一步的了解。比如你只想看到 bundle 的错误信息，那么可以配置：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  stats<span class="token operator">:</span> <span class="token string">'errors-only'</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>注意，它在与 quiet 或 noInfo 一起使用时不起作用。</strong></p> <h3 id="inline-🔑"><a href="#inline-🔑" class="header-anchor">#</a> inline 🔑</h3> <p>inline = true, inline 模式；inline = false，iframe 模式。</p> <p><strong>devServer 的实时预览功能，实际上依靠的是一个注入进页面的代理客户端与 devServer 之间的通信来实现的。如果你开启了 inline 模式，这个脚本就会注入进你的 bundle 来负责与 devServer 通信，构建信息也会实时的显示在浏览器控制台上。</strong></p> <p>相反的，如果你设置成 false，那么 devServer 将无法直接控制你正在开发的网页，这时候它会在你的页面上加一个 iframe，通过 iframe 的刷新来实现实时预览的效果。不过这时候你要通过 http://localhost:8080/webpack-dev-server/ 去访问你的应用。</p> <p><img src="/assets/img/inline.3d007868.png" alt="inline"></p> <p><strong>推荐采用默认值，即使用 inline 模式来实时预览。</strong></p> <h3 id="public"><a href="#public" class="header-anchor">#</a> public</h3> <p>一般用不到。但是如果你的本地开启了代理，将你的服务转向了另一个地址，那么这个配置项就起作用了。比如：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span><span class="token operator">:</span> <span class="token string">'mysite.com:9999'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>默认打开的地址就是 mysite.com:9999 了。</p> <p><img src="/assets/img/public.c5c2688d.png" alt="public"></p> <h3 id="publicpath-🔑"><a href="#publicpath-🔑" class="header-anchor">#</a> publicPath 🔑</h3> <p>这个是用来配置你打包后的文件路径的。比如你的服务器运行在 http://localhost:8080 上，然后 <code>output.filename</code> 设置为 bundle.js。默认情况下，<code>devServer.publicPath</code> 为 '/'，所以你可以通过 http://localhost:8080/bundle.js 来访问你打包后的文件。</p> <p>你也可以自己设置具体的路径：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  publicPath<span class="token operator">:</span> <span class="token string">'/assets/'</span>
  <span class="token comment">// publicPath: ''</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以看一下日志：</p> <p><img src="/assets/img/public_path.1157d8fd.png" alt="public path"></p> <p>这时候你应该通过 http://localhost:8080/assets/index.html 来访问页面，你的 bundle.js 文件也是在 http://localhost:8080/assets/ 这个目录下。</p> <p>我们可以将 public 和 publicPath 结合起来配置，例如：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  port<span class="token operator">:</span> <span class="token number">8888</span><span class="token punctuation">,</span>
  <span class="token keyword">public</span><span class="token operator">:</span> <span class="token string">'localhost:8888/assets'</span><span class="token punctuation">,</span>
  publicPath<span class="token operator">:</span> <span class="token string">'/assets/'</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="/assets/img/public_and_path.0a62be8e.png" alt="public and public path"></p> <p>有两点需要注意一下：</p> <ol><li>publicPath 的值永远要以 / 开头，以 / 结尾</li> <li><strong>publicPath 的值最好和 output.path 保持一致</strong></li></ol> <h3 id="https"><a href="#https" class="header-anchor">#</a> https</h3> <p>设置为 true 表示开启 https。你也可以指定自己的证书：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  https<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  key<span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'/path/to/server.key'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  cert<span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'/path/to/server.crt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  ca<span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'/path/to/ca.pem'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="http2"><a href="#http2" class="header-anchor">#</a> http2</h3> <p>它是一个布尔值，表示是否开启 http2 传输（基于spdy）。<strong>这个属性在 node v10+ 上无效。</strong></p> <h3 id="index"><a href="#index" class="header-anchor">#</a> index</h3> <p>打开的 index 文件的名称。默认是 index.html。当你默认的文件名不是 index.html 的时候，指定它会很有用，比如结合 HtmlWebpackPlugin 来配置：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">'DevServer Test'</span><span class="token punctuation">,</span>
      filename<span class="token operator">:</span> <span class="token string">'hello.html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    index<span class="token operator">:</span> <span class="token string">'hello.html'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样的配置能保证我们正确的打开 index 文件。</p> <h3 id="allowedhosts"><a href="#allowedhosts" class="header-anchor">#</a> allowedHosts</h3> <p>配置哪些主机访问我们的服务。</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  allowedHosts<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'baidu.com'</span><span class="token punctuation">,</span>
    <span class="token string">'.hello.com'</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="disablehostcheck"><a href="#disablehostcheck" class="header-anchor">#</a> disableHostCheck</h3> <p>设置为 true 的话表示禁用主机检查，这时候你可以接收来自任意主机的请求。<strong>非常不推荐设置为 true，因为这容易让你收到 DNS 重绑定攻击。</strong></p> <h3 id="host-🔑"><a href="#host-🔑" class="header-anchor">#</a> host 🔑</h3> <p>指定要使用的主机。</p> <p>这个配置非常有用，项目开发的时候，我们常常遇到这样的情况，你本地改了一个东西，还没上测试环境，想让别人先看看效果，你就需要别人访问你电脑上运行的应用，这时你需要配置：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  host<span class="token operator">:</span> <span class="token string">'0.0.0.0'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>你将你的 ip 发给你的同事，它就可以通过 ip:port/path/to/app 来访问你电脑上的服务了。这时候你的 disableHostCheck 需要设置为 true，因为别人是通过你的 ip 来访问的。</p> <h3 id="uselocalip"><a href="#uselocalip" class="header-anchor">#</a> useLocalIp</h3> <p>是否使用本地 ip 打开浏览器。默认是 false。</p> <p>要想这个属性起作用，你的 host 属性要么是本地的 ip，要么是 0.0.0.0。这个属性很少用到，实在要配置的话，参考如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  host<span class="token operator">:</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>
  useLocalIp<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="hot-🔑"><a href="#hot-🔑" class="header-anchor">#</a> hot 🔑</h3> <p>开启热模块更新（HMR）</p> <h3 id="hotonly-🔑"><a href="#hotonly-🔑" class="header-anchor">#</a> hotOnly 🔑</h3> <p>当构建失败的时候，也不要刷新浏览器，依旧使用 HMR。通常我们一起设置：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  hotOnly<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="contentbase-🔑"><a href="#contentbase-🔑" class="header-anchor">#</a> contentBase 🔑</h3> <p>我们知道，devServer 通过 HTTP 服务暴露出来的文件分为两类。一类是 webpack 打包出的文件，一类是本地的静态文件。前者我们可以通过 publicPath 来指定服务的地址，后者就要靠我们的 contentBase 来指定了。比如：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  contentBase<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'public'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这就把项目根目录下的 public 文件夹作为服务文件的路径了。如果这时候你项目根目录下有一个 public 文件夹，文件夹里有一个 hello.txt 文件，那么你就可以通过 http://localhost:8091/hello.txt 来访问这个文件了。</p> <p>如果你有多个文件夹需要指定，也可以配置成数组：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  contentBase<span class="token operator">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'assets'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="contentbasepublicpath-🔑"><a href="#contentbasepublicpath-🔑" class="header-anchor">#</a> contentBasePublicPath 🔑</h3> <p><strong>这是 webpack V5 新增的特性。</strong> 它给你的 contentBase 里面服务的内容加上访问前缀。比如：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  contentBase<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  contentBasePublicPath<span class="token operator">:</span> <span class="token string">'/ppp'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>你在浏览器的访问路径前面就要加上 ppp 前缀：http://localhost:8091/ppp/hello.txt。如果你 contentBase 配置的是数组，那么你这个也要配置成对应的数组。</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  contentBase<span class="token operator">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'assets'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  contentBasePublicPath<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'/public'</span><span class="token punctuation">,</span> <span class="token string">'/assets'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="watchcontentbase"><a href="#watchcontentbase" class="header-anchor">#</a> watchContentBase</h3> <p>告诉 dev-server 去监听 devServer.contentBase 路径下的文件。如果设置为它 true 的话，那么该目录下任意文件的修改都会出发页面的刷新。</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  contentBase<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  watchContentBase<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><p>（我结合上面的 hello.txt 试了，我修改 hello.txt 文件后，页面并没有刷新。不知道是哪里出了问题，待研究。）</p> <h3 id="watchoptions"><a href="#watchoptions" class="header-anchor">#</a> watchOptions</h3> <p>文件监听相关的控制。可以参考 watchOptions 章节，他们的配置是一样的。</p> <h3 id="headers"><a href="#headers" class="header-anchor">#</a> headers</h3> <p>给所有的响应添加响应头。</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  headers<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'X-header'</span><span class="token operator">:</span> <span class="token string">'This is custom header'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>结果：</p> <p><img src="/assets/img/headers.ce2cc8d5.png" alt="headers"></p> <h3 id="livereload"><a href="#livereload" class="header-anchor">#</a> liveReload</h3> <p>控制浏览器是否实时刷新。默认情况下，当监测到文件改变时，dev-server 会刷新页面。要想 liveReload 生效的话，devServer.hot 要为 false，或者 devServer.watchContentBase 为 true。</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  liveReload<span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="socket-相关"><a href="#socket-相关" class="header-anchor">#</a> socket 相关</h3> <p>这个我们几乎很少去配置，做一个了解即可。</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  socket<span class="token operator">:</span> <span class="token string">'socket'</span><span class="token punctuation">,</span> <span class="token comment">// 要监听的 Unix socket</span>
  sockHost<span class="token operator">:</span> <span class="token string">'mysocket.test'</span><span class="token punctuation">,</span> <span class="token comment">// 告诉连接到 devServer 的客户端使用提供的 socket 主机</span>
  sockPath<span class="token operator">:</span> <span class="token string">'/mysocket'</span><span class="token punctuation">,</span> <span class="token comment">// 访问 socket 的路径</span>
  sockPort<span class="token operator">:</span> <span class="token number">8080</span> <span class="token comment">// 告诉客户端使用这个端口去连接 devServer</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="historyapifallback-🔑"><a href="#historyapifallback-🔑" class="header-anchor">#</a> historyApiFallback 🔑</h3> <p>当使用 HTML5 History API 的时候，index.html 还要承载着 404 的请求。通过设置这个属性为 true 可以解决这个问题：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  historyApiFallback<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这时候，你访问一个不存在的路径，也会去请求 index.html 文件的内容。</p> <p>这个属性还支持更高级的配置：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  historyApiFallback<span class="token operator">:</span> <span class="token punctuation">{</span>
    rewrites<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> <span class="token keyword">from</span><span class="token operator">:</span> <span class="token regex">/^\/$/</span><span class="token punctuation">,</span> to<span class="token operator">:</span> <span class="token string">'/views/landing.html'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token keyword">from</span><span class="token operator">:</span> <span class="token regex">/^\/subpage/</span><span class="token punctuation">,</span> to<span class="token operator">:</span> <span class="token string">'/views/subpage.html'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token keyword">from</span><span class="token operator">:</span> <span class="token regex">/./</span><span class="token punctuation">,</span> to<span class="token operator">:</span> <span class="token string">'/views/404.html'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>有兴趣的话可以自己尝试一下。</p> <h3 id="proxy-🔑"><a href="#proxy-🔑" class="header-anchor">#</a> proxy 🔑</h3> <p>想必这个属性大家都很熟悉，开发过程中经常会需要配置它来实现跨域。详细的配置可以参考 <a href="https://github.com/chimurai/http-proxy-middleware#options" target="_blank" rel="noopener noreferrer">http-proxy-middleware<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 这个包，这里我们介绍常见的几种。</p> <p>当你的后端部署在 35.123.18.192 上的时候，你可以这么配置：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token string">'http://35.123.18.192'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这时候，如果在代码中请求 /api/users ，这个请求会被代理发送到 http://35.123.18.192/api/users。</p> <p>当你不想要发送 /api 这个前缀的时候，你可以使用 pathRewrite 来改掉它，这时候要将路径对应的值设置成对象：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">'http://35.123.18.192'</span><span class="token punctuation">,</span>
        pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">'^/api'</span><span class="token operator">:</span> <span class="token string">''</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这里配置的 pathRewrite 表示，如果一个请求路径以 /api 开头，统一的将 /api 去掉，也就是说 <code>axios.get('/api/users/')</code> 实际上会发送：<code>http://35.123.18.192/users</code> 这个请求。你也可以通过这个 pathRewrite 做一些有意思的事，比如这个场景：后端某个接口没写完，它要给你一个 mock 接口，你就可以在这里配置重写规则了，比如：</p> <div class="language-js extra-class"><pre class="language-js"><code>pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">'/users'</span><span class="token operator">:</span> <span class="token string">'/fake-users'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果你想代理多个路径到同一个目标服务器上，你还可以使用 context 属性来配置：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  proxy<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    context<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'/auth'</span><span class="token punctuation">,</span> <span class="token string">'/api'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    target<span class="token operator">:</span> <span class="token string">'http://localhost:3000'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    context<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'/v2/auth'</span><span class="token punctuation">,</span> <span class="token string">'/v2/api'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    target<span class="token operator">:</span> <span class="token string">'http://localhost:4000'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>默认情况下，使用无效证书运行在HTTPS上的后端服务器将不被接受。如果需要，可以像这样修改配置：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      target<span class="token operator">:</span> <span class="token string">'https://xxx.com'</span><span class="token punctuation">,</span>
      secure<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果你想选择性的代理一些请求，比如针对 API 请求走代理，针对 html 页面请求不走代理，你可以使用 bypass 来控制这种行为：</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function">bypass</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> proxy</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Skipping proxy for browser request.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token string">'/index.html'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>bypass 是一个函数，它的规则是这样的：</p> <ul><li>如果返回 null 或者 undefined，使用代理来处理请求；</li> <li>如果返回 false，那么这个请求结果为 404</li> <li>返回一个路径，就去请求这个路径的资源，不走代理</li></ul> <p>默认情况下，原始的 Host 头是被一直保留的，也就是说，代理过去的请求头中的 Host 的值是最原始的。举个例子，我配置了 proxy 访问 35.123.23.24 服务器。应用在本地运行后，默认情况下，devServer 发送到远程服务器的请求头的 Host 字段，是 localhost，但是这个对于远端服务器来说，可能会被拒绝。所以有的情况下，你可以将 changeOrigin 设置为 true 来修改这种默认行为。</p> <div class="language-js extra-class"><pre class="language-js"><code>devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
  proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      target<span class="token operator">:</span> <span class="token string">'http://35.123.23.23'</span><span class="token punctuation">,</span>
      changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">8/27/2020, 10:34:26 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/tools/webpack/output.html" class="prev">
        output
      </a></span> <span class="next"><a href="/tools/webpack/performance.html">
        performance
      </a>
      →
    </span></p></div> <div class="adsense-content" data-v-5abe131a><div style="padding: 2rem 2rem 1rem 2rem" data-v-5abe131a></div></div></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.60e74413.js" defer></script><script src="/assets/js/14.69f023c0.js" defer></script><script src="/assets/js/2.720ba71e.js" defer></script><script src="/assets/js/6.95b28193.js" defer></script>
  </body>
</html>
