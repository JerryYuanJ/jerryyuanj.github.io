<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cookie | Jerry 个人博客</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <script>
      (function() {
        var mta = document.createElement("script");
        mta.src = "//pingjs.qq.com/h5/stats.js?v2.0.4";
        mta.setAttribute("name", "MTAH5");
        mta.setAttribute("sid", "500708667");
        mta.setAttribute("cid", "500708668");
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(mta, s);
      })();
    </script>
    <script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="Jerry's blog">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/assets/css/0.styles.06744937.css" as="style"><link rel="preload" href="/assets/js/app.60e74413.js" as="script"><link rel="preload" href="/assets/js/14.69f023c0.js" as="script"><link rel="preload" href="/assets/js/2.720ba71e.js" as="script"><link rel="preload" href="/assets/js/26.a5e7b497.js" as="script"><link rel="prefetch" href="/assets/js/10.4356ad27.js"><link rel="prefetch" href="/assets/js/100.c99580b9.js"><link rel="prefetch" href="/assets/js/101.356781a9.js"><link rel="prefetch" href="/assets/js/11.b045add9.js"><link rel="prefetch" href="/assets/js/12.aeedaf60.js"><link rel="prefetch" href="/assets/js/13.fb627b38.js"><link rel="prefetch" href="/assets/js/15.9fedbce0.js"><link rel="prefetch" href="/assets/js/16.1a7de72a.js"><link rel="prefetch" href="/assets/js/17.fa224a6a.js"><link rel="prefetch" href="/assets/js/18.1a72bef8.js"><link rel="prefetch" href="/assets/js/19.e11c0116.js"><link rel="prefetch" href="/assets/js/20.6a6f73dd.js"><link rel="prefetch" href="/assets/js/21.56a777d3.js"><link rel="prefetch" href="/assets/js/22.6773a84c.js"><link rel="prefetch" href="/assets/js/23.136061fb.js"><link rel="prefetch" href="/assets/js/24.7d1837f0.js"><link rel="prefetch" href="/assets/js/25.31ab58df.js"><link rel="prefetch" href="/assets/js/27.9609abfa.js"><link rel="prefetch" href="/assets/js/28.bbb9cd06.js"><link rel="prefetch" href="/assets/js/29.8892b17d.js"><link rel="prefetch" href="/assets/js/3.b7eab624.js"><link rel="prefetch" href="/assets/js/30.74b203cc.js"><link rel="prefetch" href="/assets/js/31.f8502b39.js"><link rel="prefetch" href="/assets/js/32.4a6fdb4c.js"><link rel="prefetch" href="/assets/js/33.06378ca2.js"><link rel="prefetch" href="/assets/js/34.0060ef5f.js"><link rel="prefetch" href="/assets/js/35.1635574b.js"><link rel="prefetch" href="/assets/js/36.ba0ea7aa.js"><link rel="prefetch" href="/assets/js/37.1fe72493.js"><link rel="prefetch" href="/assets/js/38.6140df13.js"><link rel="prefetch" href="/assets/js/39.75defbda.js"><link rel="prefetch" href="/assets/js/4.99432b89.js"><link rel="prefetch" href="/assets/js/40.95f6174a.js"><link rel="prefetch" href="/assets/js/41.edc39790.js"><link rel="prefetch" href="/assets/js/42.9dcf7ed0.js"><link rel="prefetch" href="/assets/js/43.027f7ff4.js"><link rel="prefetch" href="/assets/js/44.a7fa2c02.js"><link rel="prefetch" href="/assets/js/45.3bd0a364.js"><link rel="prefetch" href="/assets/js/46.6682a04b.js"><link rel="prefetch" href="/assets/js/47.a61c377c.js"><link rel="prefetch" href="/assets/js/48.1f4bbd9a.js"><link rel="prefetch" href="/assets/js/49.7f23a237.js"><link rel="prefetch" href="/assets/js/5.406f67b1.js"><link rel="prefetch" href="/assets/js/50.2a56a559.js"><link rel="prefetch" href="/assets/js/51.bb97c3da.js"><link rel="prefetch" href="/assets/js/52.446d5740.js"><link rel="prefetch" href="/assets/js/53.e8184b0c.js"><link rel="prefetch" href="/assets/js/54.c9a5e3ed.js"><link rel="prefetch" href="/assets/js/55.97bb4c63.js"><link rel="prefetch" href="/assets/js/56.cb3d973f.js"><link rel="prefetch" href="/assets/js/57.37f3fb00.js"><link rel="prefetch" href="/assets/js/58.0d7c2f4b.js"><link rel="prefetch" href="/assets/js/59.4a2f6def.js"><link rel="prefetch" href="/assets/js/6.95b28193.js"><link rel="prefetch" href="/assets/js/60.b2a604a0.js"><link rel="prefetch" href="/assets/js/61.debbb7b9.js"><link rel="prefetch" href="/assets/js/62.0bd56b0e.js"><link rel="prefetch" href="/assets/js/63.57bf8cbe.js"><link rel="prefetch" href="/assets/js/64.41c1fb35.js"><link rel="prefetch" href="/assets/js/65.f53d1b42.js"><link rel="prefetch" href="/assets/js/66.566689b9.js"><link rel="prefetch" href="/assets/js/67.f5cf077d.js"><link rel="prefetch" href="/assets/js/68.95bc1b6c.js"><link rel="prefetch" href="/assets/js/69.bdc844a1.js"><link rel="prefetch" href="/assets/js/7.6619bfc9.js"><link rel="prefetch" href="/assets/js/70.94a6894a.js"><link rel="prefetch" href="/assets/js/71.4e9ddb06.js"><link rel="prefetch" href="/assets/js/72.2c8413d7.js"><link rel="prefetch" href="/assets/js/73.64fdac61.js"><link rel="prefetch" href="/assets/js/74.a6f66ae3.js"><link rel="prefetch" href="/assets/js/75.9e940b3a.js"><link rel="prefetch" href="/assets/js/76.7e0d8e19.js"><link rel="prefetch" href="/assets/js/77.c67342fb.js"><link rel="prefetch" href="/assets/js/78.a5bd97d1.js"><link rel="prefetch" href="/assets/js/79.3a3e3541.js"><link rel="prefetch" href="/assets/js/8.d0a8a3ed.js"><link rel="prefetch" href="/assets/js/80.97620f66.js"><link rel="prefetch" href="/assets/js/81.0d8341aa.js"><link rel="prefetch" href="/assets/js/82.0d309601.js"><link rel="prefetch" href="/assets/js/83.6123aeae.js"><link rel="prefetch" href="/assets/js/84.00b21399.js"><link rel="prefetch" href="/assets/js/85.d22ae4f9.js"><link rel="prefetch" href="/assets/js/86.a79065fe.js"><link rel="prefetch" href="/assets/js/87.01664722.js"><link rel="prefetch" href="/assets/js/88.1cb8429e.js"><link rel="prefetch" href="/assets/js/89.a36be8c5.js"><link rel="prefetch" href="/assets/js/9.f2277063.js"><link rel="prefetch" href="/assets/js/90.ebfec47e.js"><link rel="prefetch" href="/assets/js/91.47f73c78.js"><link rel="prefetch" href="/assets/js/92.4ae86837.js"><link rel="prefetch" href="/assets/js/93.8bbf0769.js"><link rel="prefetch" href="/assets/js/94.8f1e3309.js"><link rel="prefetch" href="/assets/js/95.ea1c2085.js"><link rel="prefetch" href="/assets/js/96.08475163.js"><link rel="prefetch" href="/assets/js/97.a8c7442e.js"><link rel="prefetch" href="/assets/js/98.9d7ce618.js"><link rel="prefetch" href="/assets/js/99.eb0c7f6a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.06744937.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Jerry 个人博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/js/index.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/basic/css/index.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/basic/html/index.html" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/http/index.html" class="nav-link">
  HTTP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue 系列" class="dropdown-title"><span class="title">Vue 系列</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/vue/vue2/index.html" class="nav-link">
  Vue 2
</a></li><li class="dropdown-item"><!----> <a href="/tools/vue/vue3/index.html" class="nav-link">
  Vue 3
</a></li><li class="dropdown-item"><!----> <a href="/tools/vue/vuex/index.html" class="nav-link">
  Vuex
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="源码精读" class="dropdown-title"><span class="title">源码精读</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/snabbdom/index.html" class="nav-link">
  Snabbdom
</a></li><li class="dropdown-item"><!----> <a href="/tools/axios/index.html" class="nav-link">
  Axios
</a></li></ul></div></div><div class="nav-item"><a href="/backend/" class="nav-link">
  技能拓展
</a></div><div class="nav-item"><a href="/tools/webpack/" class="nav-link">
  Webpack
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About Me
</a></div> <a href="https://github.com/JerryYuanJ/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/js/index.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/basic/css/index.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/basic/html/index.html" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/http/index.html" class="nav-link">
  HTTP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue 系列" class="dropdown-title"><span class="title">Vue 系列</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/vue/vue2/index.html" class="nav-link">
  Vue 2
</a></li><li class="dropdown-item"><!----> <a href="/tools/vue/vue3/index.html" class="nav-link">
  Vue 3
</a></li><li class="dropdown-item"><!----> <a href="/tools/vue/vuex/index.html" class="nav-link">
  Vuex
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="源码精读" class="dropdown-title"><span class="title">源码精读</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/snabbdom/index.html" class="nav-link">
  Snabbdom
</a></li><li class="dropdown-item"><!----> <a href="/tools/axios/index.html" class="nav-link">
  Axios
</a></li></ul></div></div><div class="nav-item"><a href="/backend/" class="nav-link">
  技能拓展
</a></div><div class="nav-item"><a href="/tools/webpack/" class="nav-link">
  Webpack
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About Me
</a></div> <a href="https://github.com/JerryYuanJ/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>HTTP</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/http/history.html" class="sidebar-link">HTTP的发展历程</a></li><li><a href="/http/cache.html" class="sidebar-link">HTTP缓存</a></li><li><a href="/http/cookie.html" aria-current="page" class="active sidebar-link">HTTP Cookie</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/http/cookie.html#什么是cookie" class="sidebar-link">什么是Cookie</a></li><li class="sidebar-sub-header"><a href="/http/cookie.html#cookie的简单使用" class="sidebar-link">Cookie的简单使用</a></li><li class="sidebar-sub-header"><a href="/http/cookie.html#cookie详解" class="sidebar-link">Cookie详解</a></li><li class="sidebar-sub-header"><a href="/http/cookie.html#cookie的限制" class="sidebar-link">Cookie的限制</a></li></ul></li><li><a href="/http/headers.html" class="sidebar-link">HTTP Headers</a></li><li><a href="/http/status-code.html" class="sidebar-link">HTTP Status Code</a></li><li><a href="/http/https.html" class="sidebar-link">HTTPS</a></li><li><a href="/http/cors.html" class="sidebar-link">跨域与CORS</a></li><li><a href="/http/hand-shake.html" class="sidebar-link">TCP / 三次握手和四次挥手</a></li><li><a href="/http/security.html" class="sidebar-link">Web安全</a></li></ul></section></li></ul> <div class="adsense-content" data-v-8d82fd90><div style="padding: 2rem" data-v-8d82fd90></div></div></aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="cookie"><a href="#cookie" class="header-anchor">#</a> Cookie</h1> <h2 id="什么是cookie"><a href="#什么是cookie" class="header-anchor">#</a> 什么是Cookie</h2> <p>我们知道，HTTP是无状态的协议，也就是说，如果你在访问某个网站，单从HTTP协议的角度来说，网站的服务器是不知道你的上一次请求情况的。但是我们很多场景都需要我们的服务器记住用户之前的某些操作，举个很常见的例子，当我们登陆淘宝时，浏览不同的页面，淘宝不会让我们重复的登陆，这就说明它记录下了我们的登陆状态。实现这个功能有很多种方式，其中一种就是<strong>Cookie</strong>机制。</p> <p>HTTP Cookie（也叫Web Cookie或浏览器Cookie）是服务器发送到用户浏览器并保存在本地的<strong>一小块数据</strong>，它会在浏览器下次再次发送请求时，<strong>满足条件的情况下</strong>，随着请求报文一并发送到服务器上。<strong>Cookie 使基于无状态的HTTP协议记录稳定的状态信息成为了可能。</strong></p> <h2 id="cookie的简单使用"><a href="#cookie的简单使用" class="header-anchor">#</a> Cookie的简单使用</h2> <p>服务器会在响应头部<strong>Set-Cookie</strong>中设置相应的Cookie值，比如：</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">Set-Cookie</span><span class="token punctuation">:</span> sid=123456
</code></pre></div><p>上面的头部就会设置一个名称为<code>sid</code>，值为<code>123456</code>的Cookie值到我们的浏览器上。浏览器在下一次往相同服务器发送请求时，会在<code>Cookie</code>的请求头部上带上这个信息：</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">Cookie</span><span class="token punctuation">:</span> sid=123456
</code></pre></div><p>同时，你可以通过js来获取这个cookie的值：</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span>cookie <span class="token comment">// 输出 sid=123456</span>
</code></pre></div><p>我们也可以通过Chrome DevTools中的Application面板看到网站的cookies，例如github的网站上的cookies如图所示：</p> <p><img src="/assets/img/cookie.63a491fc.png" alt="Cookies"></p> <h2 id="cookie详解"><a href="#cookie详解" class="header-anchor">#</a> Cookie详解</h2> <p>关于Cookie，除了名称和值这两个字段外，它有如下几个比较重要的标记信息：</p> <ol><li><strong>过期时间：<code>Expire/Max-Age</code></strong></li></ol> <p>根据Cookie是否携带过期时间，我们通常将Cookie分为两类：<strong>会话期Cookie</strong>和<strong>持久性Cookie</strong>。会话期Cookie的生命周期仅存于会话期，即关闭网页或者浏览器，这个Cookie就会被删除；而持久性Cookie则会在到期之前一直有效，不论浏览器是否关闭，<strong>它的时间是相对于客户端而言的</strong>。</p> <p><code>Expire</code>和<code>Max-Age</code>都是用来表示过期时间的，不同的是，<code>Expires</code>的值是一个具体的日期值，它表示该Cookie在该日期之前都有效；<code>Max-Age</code>的值是一个数字，它表示经过多少<strong>秒</strong>这个cookie会失效，这个属性在一些老的浏览器不支持。如果<code>Expires</code>和<code>Max-Age</code>都存在，并且在浏览器都支持的情况下，<code>Max-Age</code>的优先级要高。例如：</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">Set-Cookie</span><span class="token punctuation">:</span> id=12; Expires=Wed<span class="token punctuation">,</span> 21 Jan 2020 07<span class="token punctuation">:</span>28<span class="token punctuation">:</span>00 GMT
<span class="token key atrule">Set-Cookie</span><span class="token punctuation">:</span> id=123; Max<span class="token punctuation">-</span>Age=10000
</code></pre></div><p>上面设置了名为<code>id</code>的cookie，它设置的失效时间<code>Expires</code>为2020年1月21日07:28:00，生效时长<code>Max-Age</code>为10秒，假设浏览器对于这两个属性都支持的话，那么<code>Max-Age</code>的值将会被采用，也就是说，这个cookie将会在10秒后失效。</p> <p><strong>如果要手动的删除某个某个cookie的值，可以将它的Expires属性设置为一个过去的时间点，或者Max-Age属性设置为0或-1。</strong></p> <ol start="2"><li><strong>Secure</strong></li></ol> <p>设置为<code>Secure</code>的Cookie，只会在<strong>https</strong>的环境下被发送给服务端。但是要注意的是，即使在https环境下，敏感信息也<strong>不应该</strong>通过Cookie传输。</p> <ol start="3"><li><strong>HttpOnly</strong></li></ol> <p>我们知道，JavaScript的API<code>document.cookie</code>可以获取当前网站下的cookie。如果你不想让js来获取某一个cookie值时，给这个cookie加上<code>HttpOnly</code>的标记即可，例如：</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">Set-Cookie</span><span class="token punctuation">:</span> id=1; Secure; HttpOnly; 
</code></pre></div><p>这个名称为<code>id</code>的cookie，通过js是获取不到的。</p> <ol start="4"><li><strong>Domain</strong></li></ol> <p>指定Cookie对于哪个域是有效的。如果没有指定的话，默认值就是当前网页的URL（不包含子域）；反之如果指定的话，那么各个子域也包含这个Cookie。比如：</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">Set-Cookie</span><span class="token punctuation">:</span> sid=123; Domain=test.com
</code></pre></div><p>上例设置了一个名称为<code>sid</code>的cookie，它对于域名为<code>test.com</code>的域都是有效的，当然也包括它的子域，即我们在<code>a.test.com</code>或者<code>b.test.com</code>中，都可以访问到这个cookie。</p> <ol start="5"><li><strong>Path</strong></li></ol> <p>指定对于域中的某一路径，在这个路径下才会向服务器发送cookie。例如：</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">Set-Cookie</span><span class="token punctuation">:</span> sid=123; Path=/test; Domain=www.test.com
</code></pre></div><p>这里例子中，我们设置了名为<code>sid</code>的cookie，它会在域名为<code>www.test.com</code>，路径为<code>/test</code>的url下才会生效，比如我们请求一个资源，它的路径为<code>http://www.test.com/test</code>或者子路径<code>http://www.test.com/test/images/1.png</code>，那么这个cookie就会被发送。</p> <ol start="6"><li><strong>SameSite</strong></li></ol> <p>这个属性早在Chrome51的时候就被引入了，它的初衷是为了阻止CSRF攻击。<code>SameSite</code>的值可以为下面的三个之一：</p> <ol><li>Strict</li></ol> <p>这是要求最严格的，完全禁止第三方Cookie，只有当前网页URL与请求目标一致，才会发送Cookie。这个属性带来的用户体验非常不好，举个例子，你登陆淘宝后，假设淘宝网给你的Cookie设置的是<code>SameSite=Strict</code>，这时候你点击网站的商品准备看看详情，Oops，你又得重新登陆才可以继续进行你的操作，因为跳转的时候，淘宝的Cookie是不会附带到请求上去的。</p> <ol start="2"><li>Lax</li></ol> <p><code>Lax</code>的要求则没有这么严格，但是大部分情况下它也是不发送Cookie的，除非是一些导航到目标网址的<code>GET</code>请求。这里的重点是：<code>GET</code>方法，而且必须是可以造成顶级导航的<code>GET</code>方法，只有这样，<code>Lax</code>的Cookie才会被发送。</p> <p>关于什么是“造成顶级导航”，这里解释一下。资源可以通过<code>img</code>、<code>iframe</code>、<code>script</code>标签进行加载，这些都可以通过<code>GET</code>请求来获取，但是它们都不会造成顶级的导航改变。基本上，它们不会更改地址栏中的URL，所以它们发出的请求，都不会带上<code>Lax</code>的Cookie。可以参考下面的表格：</p> <table><thead><tr><th>请求类型</th> <th style="text-align:center;">示例代码</th> <th style="text-align:right;">发送的Cookie</th></tr></thead> <tbody><tr><td>Link</td> <td style="text-align:center;"><code>&lt;a href=&quot;...&quot;&gt;&lt;/a&gt;</code></td> <td style="text-align:right;">Normal, Lax</td></tr> <tr><td>Perender</td> <td style="text-align:center;"><code>&lt;link rel=&quot;prerender&quot; href=&quot;..&quot;/&gt;</code></td> <td style="text-align:right;">Normal, Lax</td></tr> <tr><td>Form GET</td> <td style="text-align:center;"><code>&lt;form method=&quot;GET&quot; action=&quot;...&quot;&gt;</code></td> <td style="text-align:right;">Normal, Lax</td></tr> <tr><td>Form POST</td> <td style="text-align:center;"><code>&lt;form method=&quot;POST&quot; action=&quot;...&quot;&gt;</code></td> <td style="text-align:right;">Normal</td></tr> <tr><td>iframe</td> <td style="text-align:center;"><code>&lt;iframe src=&quot;...&quot;&gt;&lt;/iframe&gt;</code></td> <td style="text-align:right;">Normal</td></tr> <tr><td>AJAX</td> <td style="text-align:center;"><code>$.get(&quot;...&quot;)</code></td> <td style="text-align:right;">Normal</td></tr> <tr><td>Image</td> <td style="text-align:center;"><code>&lt;img src=&quot;...&quot;&gt;</code></td> <td style="text-align:right;">Normal</td></tr></tbody></table> <ol start="3"><li>None</li></ol> <p>浏览器会在同站请求、跨站请求下继续发送cookie。不过最近由谷歌发出的提议，如果Cookie的<code>SameSite=None</code>，那么它必须包含<code>Secure</code>标记，比如：</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">Set-Cookie</span><span class="token punctuation">:</span> widget_session=abc123; SameSite=None // 这是一个无效的Cookie
<span class="token key atrule">Set-Cookie</span><span class="token punctuation">:</span> widget_session=abc123; SameSite=None; Secure // 有效
</code></pre></div><h2 id="cookie的限制"><a href="#cookie的限制" class="header-anchor">#</a> Cookie的限制</h2> <p>Cookie的限制主要体现在以下几点：</p> <ul><li>需要满足<code>domain</code>和<code>path</code>的作用域约束</li> <li>每个域的cookie的总数是有限制的，不同浏览器肯可能限制大小有所不同</li> <li>浏览器对cookie的大小也有限制，不同浏览器的上限也不同</li></ul> <p>Cookie最早是用来作为客户端存储的一种手段的，但是随着<a href="https://developer.mozilla.org/en-US/docs/Web/API/Storage" target="_blank" rel="noopener noreferrer"><code>Storage</code>API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的兴起，我们已经不需要它来承担存储性的工作了。</p> <h3 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h3> <ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie" target="_blank" rel="noopener noreferrer">HTTP Headers：Set-Cookie - MDN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Cookies" target="_blank" rel="noopener noreferrer">Cookies - MDN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://web.dev/samesite-cookies-explained/" target="_blank" rel="noopener noreferrer">SameSite cookies explained<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.netsparker.com/blog/web-security/same-site-cookie-attribute-prevent-cross-site-request-forgery/" target="_blank" rel="noopener noreferrer">Using the Same-Site Cookie Attribute to Prevent CSRF Attacks<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">3/5/2020, 11:28:07 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/http/cache.html" class="prev">
        HTTP缓存
      </a></span> <span class="next"><a href="/http/headers.html">
        HTTP Headers
      </a>
      →
    </span></p></div> <div class="adsense-content" data-v-5abe131a><div style="padding: 2rem 2rem 1rem 2rem" data-v-5abe131a></div></div></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.60e74413.js" defer></script><script src="/assets/js/14.69f023c0.js" defer></script><script src="/assets/js/2.720ba71e.js" defer></script><script src="/assets/js/26.a5e7b497.js" defer></script>
  </body>
</html>
